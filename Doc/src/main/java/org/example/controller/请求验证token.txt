// å®šä¹‰ä¸€ä¸ªå˜é‡å­˜ Token
window.myToken = "";

fetch('http://localhost:8080/user/login', {
    method: 'POST',
    headers: { 'Content-Type': 'application/json' },
    body: JSON.stringify({
        username: "admin",  // æ•°æ®åº“é‡Œåˆå§‹åŒ–çš„è´¦å·
        password: "123456"  // æ•°æ®åº“é‡Œåˆå§‹åŒ–çš„å¯†ç 
    })
})
.then(response => response.json())
.then(data => {
    console.log("ğŸ”Œ ç™»å½•æ¥å£è¿”å›:", data);

    // å¦‚æœ code æ˜¯ 200ï¼Œè¯´æ˜ç™»å½•æˆåŠŸ
    if (data.code === 200) {
        // æ ¹æ®ä½ çš„ Result ç»“æ„ï¼Œtoken åº”è¯¥åœ¨ data.data é‡Œ
        window.myToken = data.data;
        console.log("âœ… æˆåŠŸï¼Token å·²ä¿å­˜ï¼Œå®ƒæ˜¯:", window.myToken);
        console.log("ğŸ‘‰ æ—¢ç„¶æœ‰äº† Tokenï¼Œç°åœ¨ä½ å¯ä»¥è¿è¡Œç¬¬ä¸‰æ­¥çš„ä»£ç äº†ï¼");
    } else {
        console.error("âŒ ç™»å½•å¤±è´¥ï¼Œè¯·æ£€æŸ¥è´¦å·å¯†ç æˆ–æ•°æ®åº“");
    }
});

ç¬¬äºŒæ®µï¼š
fetch('http://localhost:8080/doc/create', {
    method: 'POST',
    headers: {
        'Content-Type': 'application/json',
        // ã€å…³é”®ç‚¹ã€‘è¿™é‡Œå°±æ˜¯æ‹¦æˆªå™¨ LoginInterceptor è¦æ£€æŸ¥çš„ä¸œè¥¿ï¼
        // å¦‚æœä¸å¸¦è¿™ä¸€è¡Œï¼Œæˆ–è€… token ä¹Ÿæ˜¯é”™çš„ï¼ŒæœåŠ¡å™¨ä¼šç›´æ¥è¿”å› 401
        'Authorization': window.myToken
    },
    body: JSON.stringify({
        title: "æˆ‘çš„ç»å¯†æ–‡æ¡£.pdf",
        docType: 0,
        fileKey: "http://go-server:8081/files/secret.pdf"
        // æ³¨æ„ï¼šæˆ‘ä»¬æ²¡ä¼  ownerIdï¼Œå› ä¸ºåç«¯ä¼šä» Token é‡Œè‡ªå·±è§£æ
    })
})
.then(response => {
    console.log("ğŸ“¡ HTTPçŠ¶æ€ç :", response.status);
    return response.json();
})
.then(data => {
    console.log("ğŸ“„ åˆ›å»ºç»“æœ:", data);
    if (data.code === 200) {
        console.log("ğŸ‰ æ­å–œï¼æ–‡æ¡£åˆ›å»ºæˆåŠŸï¼ID:", data.data.docId);
    } else {
        console.error("âŒ åˆ›å»ºå¤±è´¥:", data.msg);
    }
});

ç»ˆç«¯æ£€æŸ¥æ•°æ®åº“ï¼šdocker exec -it mysql_lark mysql -uroot -proot lark_db -e "SELECT * FROM document ORDER BY id DESC LIMIT 1;"